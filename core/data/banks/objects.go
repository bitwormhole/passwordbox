package banks

////////////////////////////////////////////////////////////////////////////////

type ObjectType string

const (
	ObjectTypeBlock ObjectType = "block"
)

////////////////////////////////////////////////////////////////////////////////

type ObjectID [32]byte

////////////////////////////////////////////////////////////////////////////////

type Objects interface {
	Get(id ObjectID) ObjectHolder

	NewObjectBuilder() *ObjectBuilder
}

////////////////////////////////////////////////////////////////////////////////

type ObjectHolder interface {
	GetID() ObjectID

	Fetch() (*Object, error)

	Exists() bool
}

////////////////////////////////////////////////////////////////////////////////

type ObjectIO interface {
	Fetch(id ObjectID) (*Object, error)

	Put(o *Object) (*Object, error)
}

////////////////////////////////////////////////////////////////////////////////

type Object struct {
	ID ObjectID

	Type ObjectType

	Length uint

	Data []byte
}

////////////////////////////////////////////////////////////////////////////////

type ObjectBuilder struct {
	Type ObjectType

	Data []byte

	IO ObjectIO
}

func (inst *ObjectBuilder) Build() (*Object, error) {
	o1 := new(Object)
	o1.Type = inst.Type
	o1.Data = inst.Data
	return inst.IO.Put(o1)
}

////////////////////////////////////////////////////////////////////////////////
